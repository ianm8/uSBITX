#ifndef CW_H
#define CW_H

#define SIG_TAB 4

namespace CW
{
  // 511+512    = 1023  512 - 511  = 0
  // 0 + 512    = 512   512 - 0    = 512
  // -512 + 512 = 0     512 - -512 = 1023
  // 0 + 512    = 512   512 - 0    = 512
  static const int16_t __not_in_flash("fast_access_sram") fs4tab[SIG_TAB] =
  {
    511,
    0,
    -512,
    0
  };

  static const uint16_t __not_in_flash("fast_access_sram") gaussian_tab[312] =
  {
    32767,
    32765,
    32759,
    32748,
    32733,
    32714,
    32691,
    32664,
    32633,
    32597,
    32557,
    32513,
    32465,
    32413,
    32357,
    32297,
    32233,
    32165,
    32092,
    32016,
    31936,
    31852,
    31764,
    31673,
    31577,
    31478,
    31375,
    31269,
    31158,
    31045,
    30927,
    30806,
    30682,
    30554,
    30423,
    30289,
    30151,
    30010,
    29866,
    29718,
    29568,
    29415,
    29258,
    29099,
    28937,
    28772,
    28604,
    28434,
    28261,
    28086,
    27908,
    27727,
    27545,
    27360,
    27172,
    26983,
    26791,
    26598,
    26402,
    26204,
    26005,
    25804,
    25601,
    25396,
    25190,
    24982,
    24773,
    24562,
    24350,
    24137,
    23922,
    23707,
    23490,
    23272,
    23054,
    22834,
    22614,
    22393,
    22171,
    21949,
    21726,
    21503,
    21279,
    21054,
    20830,
    20605,
    20380,
    20155,
    19930,
    19705,
    19479,
    19254,
    19029,
    18805,
    18580,
    18356,
    18133,
    17909,
    17686,
    17464,
    17242,
    17021,
    16801,
    16581,
    16362,
    16144,
    15927,
    15711,
    15495,
    15281,
    15067,
    14855,
    14644,
    14434,
    14225,
    14018,
    13811,
    13606,
    13402,
    13200,
    12999,
    12799,
    12601,
    12405,
    12209,
    12016,
    11824,
    11633,
    11444,
    11257,
    11071,
    10887,
    10705,
    10524,
    10346,
    10168,
    9993,
    9819,
    9647,
    9477,
    9309,
    9143,
    8978,
    8815,
    8654,
    8495,
    8338,
    8183,
    8029,
    7877,
    7728,
    7580,
    7434,
    7290,
    7147,
    7007,
    6868,
    6732,
    6597,
    6464,
    6333,
    6204,
    6076,
    5951,
    5827,
    5706,
    5586,
    5467,
    5351,
    5237,
    5124,
    5013,
    4904,
    4796,
    4691,
    4587,
    4484,
    4384,
    4285,
    4188,
    4093,
    3999,
    3907,
    3816,
    3727,
    3640,
    3554,
    3470,
    3388,
    3307,
    3227,
    3149,
    3073,
    2998,
    2924,
    2852,
    2781,
    2712,
    2644,
    2578,
    2512,
    2448,
    2386,
    2325,
    2265,
    2206,
    2149,
    2092,
    2037,
    1984,
    1931,
    1879,
    1829,
    1780,
    1732,
    1685,
    1639,
    1594,
    1550,
    1507,
    1465,
    1424,
    1384,
    1345,
    1307,
    1270,
    1234,
    1198,
    1164,
    1130,
    1097,
    1065,
    1034,
    1004,
    974,
    945,
    917,
    890,
    863,
    837,
    812,
    787,
    763,
    739,
    717,
    695,
    673,
    652,
    632,
    612,
    592,
    574,
    556,
    538,
    521,
    504,
    488,
    472,
    456,
    442,
    427,
    413,
    399,
    386,
    373,
    361,
    349,
    337,
    326,
    315,
    304,
    293,
    283,
    274,
    264,
    255,
    246,
    238,
    229,
    221,
    213,
    206,
    199,
    192,
    185,
    178,
    172,
    165,
    159,
    154,
    148,
    143,
    137,
    132,
    127,
    123,
    118,
    114,
    109,
    105,
    101,
    98,
    94,
    90,
    87,
    83,
    80,
    77,
    74,
    71,
    69,
    66
  };

  static const int16_t __not_in_flash("fast_access_sram") sin_tab[1024] =
  {
    (int16_t)32767,
    (int16_t)32766,
    (int16_t)32765,
    (int16_t)32761,
    (int16_t)32757,
    (int16_t)32752,
    (int16_t)32745,
    (int16_t)32737,
    (int16_t)32728,
    (int16_t)32717,
    (int16_t)32705,
    (int16_t)32692,
    (int16_t)32678,
    (int16_t)32663,
    (int16_t)32646,
    (int16_t)32628,
    (int16_t)32609,
    (int16_t)32589,
    (int16_t)32567,
    (int16_t)32545,
    (int16_t)32521,
    (int16_t)32495,
    (int16_t)32469,
    (int16_t)32441,
    (int16_t)32412,
    (int16_t)32382,
    (int16_t)32351,
    (int16_t)32318,
    (int16_t)32285,
    (int16_t)32250,
    (int16_t)32213,
    (int16_t)32176,
    (int16_t)32137,
    (int16_t)32098,
    (int16_t)32057,
    (int16_t)32014,
    (int16_t)31971,
    (int16_t)31926,
    (int16_t)31880,
    (int16_t)31833,
    (int16_t)31785,
    (int16_t)31736,
    (int16_t)31685,
    (int16_t)31633,
    (int16_t)31580,
    (int16_t)31526,
    (int16_t)31470,
    (int16_t)31414,
    (int16_t)31356,
    (int16_t)31297,
    (int16_t)31237,
    (int16_t)31176,
    (int16_t)31113,
    (int16_t)31050,
    (int16_t)30985,
    (int16_t)30919,
    (int16_t)30852,
    (int16_t)30783,
    (int16_t)30714,
    (int16_t)30643,
    (int16_t)30571,
    (int16_t)30498,
    (int16_t)30424,
    (int16_t)30349,
    (int16_t)30273,
    (int16_t)30195,
    (int16_t)30117,
    (int16_t)30037,
    (int16_t)29956,
    (int16_t)29874,
    (int16_t)29791,
    (int16_t)29706,
    (int16_t)29621,
    (int16_t)29534,
    (int16_t)29447,
    (int16_t)29358,
    (int16_t)29268,
    (int16_t)29177,
    (int16_t)29085,
    (int16_t)28992,
    (int16_t)28898,
    (int16_t)28803,
    (int16_t)28706,
    (int16_t)28609,
    (int16_t)28510,
    (int16_t)28411,
    (int16_t)28310,
    (int16_t)28208,
    (int16_t)28105,
    (int16_t)28001,
    (int16_t)27896,
    (int16_t)27790,
    (int16_t)27683,
    (int16_t)27575,
    (int16_t)27466,
    (int16_t)27356,
    (int16_t)27245,
    (int16_t)27133,
    (int16_t)27019,
    (int16_t)26905,
    (int16_t)26790,
    (int16_t)26674,
    (int16_t)26556,
    (int16_t)26438,
    (int16_t)26319,
    (int16_t)26198,
    (int16_t)26077,
    (int16_t)25955,
    (int16_t)25832,
    (int16_t)25708,
    (int16_t)25582,
    (int16_t)25456,
    (int16_t)25329,
    (int16_t)25201,
    (int16_t)25072,
    (int16_t)24942,
    (int16_t)24811,
    (int16_t)24680,
    (int16_t)24547,
    (int16_t)24413,
    (int16_t)24279,
    (int16_t)24143,
    (int16_t)24007,
    (int16_t)23870,
    (int16_t)23731,
    (int16_t)23592,
    (int16_t)23452,
    (int16_t)23311,
    (int16_t)23170,
    (int16_t)23027,
    (int16_t)22884,
    (int16_t)22739,
    (int16_t)22594,
    (int16_t)22448,
    (int16_t)22301,
    (int16_t)22154,
    (int16_t)22005,
    (int16_t)21856,
    (int16_t)21705,
    (int16_t)21554,
    (int16_t)21403,
    (int16_t)21250,
    (int16_t)21096,
    (int16_t)20942,
    (int16_t)20787,
    (int16_t)20631,
    (int16_t)20475,
    (int16_t)20317,
    (int16_t)20159,
    (int16_t)20000,
    (int16_t)19841,
    (int16_t)19680,
    (int16_t)19519,
    (int16_t)19357,
    (int16_t)19195,
    (int16_t)19032,
    (int16_t)18868,
    (int16_t)18703,
    (int16_t)18537,
    (int16_t)18371,
    (int16_t)18204,
    (int16_t)18037,
    (int16_t)17869,
    (int16_t)17700,
    (int16_t)17530,
    (int16_t)17360,
    (int16_t)17189,
    (int16_t)17018,
    (int16_t)16846,
    (int16_t)16673,
    (int16_t)16499,
    (int16_t)16325,
    (int16_t)16151,
    (int16_t)15976,
    (int16_t)15800,
    (int16_t)15623,
    (int16_t)15446,
    (int16_t)15269,
    (int16_t)15090,
    (int16_t)14912,
    (int16_t)14732,
    (int16_t)14553,
    (int16_t)14372,
    (int16_t)14191,
    (int16_t)14010,
    (int16_t)13828,
    (int16_t)13645,
    (int16_t)13462,
    (int16_t)13279,
    (int16_t)13094,
    (int16_t)12910,
    (int16_t)12725,
    (int16_t)12539,
    (int16_t)12353,
    (int16_t)12167,
    (int16_t)11980,
    (int16_t)11793,
    (int16_t)11605,
    (int16_t)11417,
    (int16_t)11228,
    (int16_t)11039,
    (int16_t)10849,
    (int16_t)10659,
    (int16_t)10469,
    (int16_t)10278,
    (int16_t)10087,
    (int16_t)9896,
    (int16_t)9704,
    (int16_t)9512,
    (int16_t)9319,
    (int16_t)9126,
    (int16_t)8933,
    (int16_t)8739,
    (int16_t)8545,
    (int16_t)8351,
    (int16_t)8157,
    (int16_t)7962,
    (int16_t)7767,
    (int16_t)7571,
    (int16_t)7375,
    (int16_t)7179,
    (int16_t)6983,
    (int16_t)6786,
    (int16_t)6590,
    (int16_t)6393,
    (int16_t)6195,
    (int16_t)5998,
    (int16_t)5800,
    (int16_t)5602,
    (int16_t)5404,
    (int16_t)5205,
    (int16_t)5007,
    (int16_t)4808,
    (int16_t)4609,
    (int16_t)4410,
    (int16_t)4210,
    (int16_t)4011,
    (int16_t)3811,
    (int16_t)3612,
    (int16_t)3412,
    (int16_t)3212,
    (int16_t)3012,
    (int16_t)2811,
    (int16_t)2611,
    (int16_t)2410,
    (int16_t)2210,
    (int16_t)2009,
    (int16_t)1809,
    (int16_t)1608,
    (int16_t)1407,
    (int16_t)1206,
    (int16_t)1005,
    (int16_t)804,
    (int16_t)603,
    (int16_t)402,
    (int16_t)201,
    (int16_t)0,
    (int16_t)-201,
    (int16_t)-402,
    (int16_t)-603,
    (int16_t)-804,
    (int16_t)-1005,
    (int16_t)-1206,
    (int16_t)-1407,
    (int16_t)-1608,
    (int16_t)-1809,
    (int16_t)-2009,
    (int16_t)-2210,
    (int16_t)-2410,
    (int16_t)-2611,
    (int16_t)-2811,
    (int16_t)-3012,
    (int16_t)-3212,
    (int16_t)-3412,
    (int16_t)-3612,
    (int16_t)-3811,
    (int16_t)-4011,
    (int16_t)-4210,
    (int16_t)-4410,
    (int16_t)-4609,
    (int16_t)-4808,
    (int16_t)-5007,
    (int16_t)-5205,
    (int16_t)-5404,
    (int16_t)-5602,
    (int16_t)-5800,
    (int16_t)-5998,
    (int16_t)-6195,
    (int16_t)-6393,
    (int16_t)-6590,
    (int16_t)-6786,
    (int16_t)-6983,
    (int16_t)-7179,
    (int16_t)-7375,
    (int16_t)-7571,
    (int16_t)-7767,
    (int16_t)-7962,
    (int16_t)-8157,
    (int16_t)-8351,
    (int16_t)-8545,
    (int16_t)-8739,
    (int16_t)-8933,
    (int16_t)-9126,
    (int16_t)-9319,
    (int16_t)-9512,
    (int16_t)-9704,
    (int16_t)-9896,
    (int16_t)-10087,
    (int16_t)-10278,
    (int16_t)-10469,
    (int16_t)-10659,
    (int16_t)-10849,
    (int16_t)-11039,
    (int16_t)-11228,
    (int16_t)-11417,
    (int16_t)-11605,
    (int16_t)-11793,
    (int16_t)-11980,
    (int16_t)-12167,
    (int16_t)-12353,
    (int16_t)-12539,
    (int16_t)-12725,
    (int16_t)-12910,
    (int16_t)-13094,
    (int16_t)-13279,
    (int16_t)-13462,
    (int16_t)-13645,
    (int16_t)-13828,
    (int16_t)-14010,
    (int16_t)-14191,
    (int16_t)-14372,
    (int16_t)-14553,
    (int16_t)-14732,
    (int16_t)-14912,
    (int16_t)-15090,
    (int16_t)-15269,
    (int16_t)-15446,
    (int16_t)-15623,
    (int16_t)-15800,
    (int16_t)-15976,
    (int16_t)-16151,
    (int16_t)-16325,
    (int16_t)-16499,
    (int16_t)-16673,
    (int16_t)-16846,
    (int16_t)-17018,
    (int16_t)-17189,
    (int16_t)-17360,
    (int16_t)-17530,
    (int16_t)-17700,
    (int16_t)-17869,
    (int16_t)-18037,
    (int16_t)-18204,
    (int16_t)-18371,
    (int16_t)-18537,
    (int16_t)-18703,
    (int16_t)-18868,
    (int16_t)-19032,
    (int16_t)-19195,
    (int16_t)-19357,
    (int16_t)-19519,
    (int16_t)-19680,
    (int16_t)-19841,
    (int16_t)-20000,
    (int16_t)-20159,
    (int16_t)-20317,
    (int16_t)-20475,
    (int16_t)-20631,
    (int16_t)-20787,
    (int16_t)-20942,
    (int16_t)-21096,
    (int16_t)-21250,
    (int16_t)-21403,
    (int16_t)-21554,
    (int16_t)-21705,
    (int16_t)-21856,
    (int16_t)-22005,
    (int16_t)-22154,
    (int16_t)-22301,
    (int16_t)-22448,
    (int16_t)-22594,
    (int16_t)-22739,
    (int16_t)-22884,
    (int16_t)-23027,
    (int16_t)-23170,
    (int16_t)-23311,
    (int16_t)-23452,
    (int16_t)-23592,
    (int16_t)-23731,
    (int16_t)-23870,
    (int16_t)-24007,
    (int16_t)-24143,
    (int16_t)-24279,
    (int16_t)-24413,
    (int16_t)-24547,
    (int16_t)-24680,
    (int16_t)-24811,
    (int16_t)-24942,
    (int16_t)-25072,
    (int16_t)-25201,
    (int16_t)-25329,
    (int16_t)-25456,
    (int16_t)-25582,
    (int16_t)-25708,
    (int16_t)-25832,
    (int16_t)-25955,
    (int16_t)-26077,
    (int16_t)-26198,
    (int16_t)-26319,
    (int16_t)-26438,
    (int16_t)-26556,
    (int16_t)-26674,
    (int16_t)-26790,
    (int16_t)-26905,
    (int16_t)-27019,
    (int16_t)-27133,
    (int16_t)-27245,
    (int16_t)-27356,
    (int16_t)-27466,
    (int16_t)-27575,
    (int16_t)-27683,
    (int16_t)-27790,
    (int16_t)-27896,
    (int16_t)-28001,
    (int16_t)-28105,
    (int16_t)-28208,
    (int16_t)-28310,
    (int16_t)-28411,
    (int16_t)-28510,
    (int16_t)-28609,
    (int16_t)-28706,
    (int16_t)-28803,
    (int16_t)-28898,
    (int16_t)-28992,
    (int16_t)-29085,
    (int16_t)-29177,
    (int16_t)-29268,
    (int16_t)-29358,
    (int16_t)-29447,
    (int16_t)-29534,
    (int16_t)-29621,
    (int16_t)-29706,
    (int16_t)-29791,
    (int16_t)-29874,
    (int16_t)-29956,
    (int16_t)-30037,
    (int16_t)-30117,
    (int16_t)-30195,
    (int16_t)-30273,
    (int16_t)-30349,
    (int16_t)-30424,
    (int16_t)-30498,
    (int16_t)-30571,
    (int16_t)-30643,
    (int16_t)-30714,
    (int16_t)-30783,
    (int16_t)-30852,
    (int16_t)-30919,
    (int16_t)-30985,
    (int16_t)-31050,
    (int16_t)-31113,
    (int16_t)-31176,
    (int16_t)-31237,
    (int16_t)-31297,
    (int16_t)-31356,
    (int16_t)-31414,
    (int16_t)-31470,
    (int16_t)-31526,
    (int16_t)-31580,
    (int16_t)-31633,
    (int16_t)-31685,
    (int16_t)-31736,
    (int16_t)-31785,
    (int16_t)-31833,
    (int16_t)-31880,
    (int16_t)-31926,
    (int16_t)-31971,
    (int16_t)-32014,
    (int16_t)-32057,
    (int16_t)-32098,
    (int16_t)-32137,
    (int16_t)-32176,
    (int16_t)-32213,
    (int16_t)-32250,
    (int16_t)-32285,
    (int16_t)-32318,
    (int16_t)-32351,
    (int16_t)-32382,
    (int16_t)-32412,
    (int16_t)-32441,
    (int16_t)-32469,
    (int16_t)-32495,
    (int16_t)-32521,
    (int16_t)-32545,
    (int16_t)-32567,
    (int16_t)-32589,
    (int16_t)-32609,
    (int16_t)-32628,
    (int16_t)-32646,
    (int16_t)-32663,
    (int16_t)-32678,
    (int16_t)-32692,
    (int16_t)-32705,
    (int16_t)-32717,
    (int16_t)-32728,
    (int16_t)-32737,
    (int16_t)-32745,
    (int16_t)-32752,
    (int16_t)-32757,
    (int16_t)-32761,
    (int16_t)-32765,
    (int16_t)-32766,
    (int16_t)-32767,
    (int16_t)-32766,
    (int16_t)-32765,
    (int16_t)-32761,
    (int16_t)-32757,
    (int16_t)-32752,
    (int16_t)-32745,
    (int16_t)-32737,
    (int16_t)-32728,
    (int16_t)-32717,
    (int16_t)-32705,
    (int16_t)-32692,
    (int16_t)-32678,
    (int16_t)-32663,
    (int16_t)-32646,
    (int16_t)-32628,
    (int16_t)-32609,
    (int16_t)-32589,
    (int16_t)-32567,
    (int16_t)-32545,
    (int16_t)-32521,
    (int16_t)-32495,
    (int16_t)-32469,
    (int16_t)-32441,
    (int16_t)-32412,
    (int16_t)-32382,
    (int16_t)-32351,
    (int16_t)-32318,
    (int16_t)-32285,
    (int16_t)-32250,
    (int16_t)-32213,
    (int16_t)-32176,
    (int16_t)-32137,
    (int16_t)-32098,
    (int16_t)-32057,
    (int16_t)-32014,
    (int16_t)-31971,
    (int16_t)-31926,
    (int16_t)-31880,
    (int16_t)-31833,
    (int16_t)-31785,
    (int16_t)-31736,
    (int16_t)-31685,
    (int16_t)-31633,
    (int16_t)-31580,
    (int16_t)-31526,
    (int16_t)-31470,
    (int16_t)-31414,
    (int16_t)-31356,
    (int16_t)-31297,
    (int16_t)-31237,
    (int16_t)-31176,
    (int16_t)-31113,
    (int16_t)-31050,
    (int16_t)-30985,
    (int16_t)-30919,
    (int16_t)-30852,
    (int16_t)-30783,
    (int16_t)-30714,
    (int16_t)-30643,
    (int16_t)-30571,
    (int16_t)-30498,
    (int16_t)-30424,
    (int16_t)-30349,
    (int16_t)-30273,
    (int16_t)-30195,
    (int16_t)-30117,
    (int16_t)-30037,
    (int16_t)-29956,
    (int16_t)-29874,
    (int16_t)-29791,
    (int16_t)-29706,
    (int16_t)-29621,
    (int16_t)-29534,
    (int16_t)-29447,
    (int16_t)-29358,
    (int16_t)-29268,
    (int16_t)-29177,
    (int16_t)-29085,
    (int16_t)-28992,
    (int16_t)-28898,
    (int16_t)-28803,
    (int16_t)-28706,
    (int16_t)-28609,
    (int16_t)-28510,
    (int16_t)-28411,
    (int16_t)-28310,
    (int16_t)-28208,
    (int16_t)-28105,
    (int16_t)-28001,
    (int16_t)-27896,
    (int16_t)-27790,
    (int16_t)-27683,
    (int16_t)-27575,
    (int16_t)-27466,
    (int16_t)-27356,
    (int16_t)-27245,
    (int16_t)-27133,
    (int16_t)-27019,
    (int16_t)-26905,
    (int16_t)-26790,
    (int16_t)-26674,
    (int16_t)-26556,
    (int16_t)-26438,
    (int16_t)-26319,
    (int16_t)-26198,
    (int16_t)-26077,
    (int16_t)-25955,
    (int16_t)-25832,
    (int16_t)-25708,
    (int16_t)-25582,
    (int16_t)-25456,
    (int16_t)-25329,
    (int16_t)-25201,
    (int16_t)-25072,
    (int16_t)-24942,
    (int16_t)-24811,
    (int16_t)-24680,
    (int16_t)-24547,
    (int16_t)-24413,
    (int16_t)-24279,
    (int16_t)-24143,
    (int16_t)-24007,
    (int16_t)-23870,
    (int16_t)-23731,
    (int16_t)-23592,
    (int16_t)-23452,
    (int16_t)-23311,
    (int16_t)-23170,
    (int16_t)-23027,
    (int16_t)-22884,
    (int16_t)-22739,
    (int16_t)-22594,
    (int16_t)-22448,
    (int16_t)-22301,
    (int16_t)-22154,
    (int16_t)-22005,
    (int16_t)-21856,
    (int16_t)-21705,
    (int16_t)-21554,
    (int16_t)-21403,
    (int16_t)-21250,
    (int16_t)-21096,
    (int16_t)-20942,
    (int16_t)-20787,
    (int16_t)-20631,
    (int16_t)-20475,
    (int16_t)-20317,
    (int16_t)-20159,
    (int16_t)-20000,
    (int16_t)-19841,
    (int16_t)-19680,
    (int16_t)-19519,
    (int16_t)-19357,
    (int16_t)-19195,
    (int16_t)-19032,
    (int16_t)-18868,
    (int16_t)-18703,
    (int16_t)-18537,
    (int16_t)-18371,
    (int16_t)-18204,
    (int16_t)-18037,
    (int16_t)-17869,
    (int16_t)-17700,
    (int16_t)-17530,
    (int16_t)-17360,
    (int16_t)-17189,
    (int16_t)-17018,
    (int16_t)-16846,
    (int16_t)-16673,
    (int16_t)-16499,
    (int16_t)-16325,
    (int16_t)-16151,
    (int16_t)-15976,
    (int16_t)-15800,
    (int16_t)-15623,
    (int16_t)-15446,
    (int16_t)-15269,
    (int16_t)-15090,
    (int16_t)-14912,
    (int16_t)-14732,
    (int16_t)-14553,
    (int16_t)-14372,
    (int16_t)-14191,
    (int16_t)-14010,
    (int16_t)-13828,
    (int16_t)-13645,
    (int16_t)-13462,
    (int16_t)-13279,
    (int16_t)-13094,
    (int16_t)-12910,
    (int16_t)-12725,
    (int16_t)-12539,
    (int16_t)-12353,
    (int16_t)-12167,
    (int16_t)-11980,
    (int16_t)-11793,
    (int16_t)-11605,
    (int16_t)-11417,
    (int16_t)-11228,
    (int16_t)-11039,
    (int16_t)-10849,
    (int16_t)-10659,
    (int16_t)-10469,
    (int16_t)-10278,
    (int16_t)-10087,
    (int16_t)-9896,
    (int16_t)-9704,
    (int16_t)-9512,
    (int16_t)-9319,
    (int16_t)-9126,
    (int16_t)-8933,
    (int16_t)-8739,
    (int16_t)-8545,
    (int16_t)-8351,
    (int16_t)-8157,
    (int16_t)-7962,
    (int16_t)-7767,
    (int16_t)-7571,
    (int16_t)-7375,
    (int16_t)-7179,
    (int16_t)-6983,
    (int16_t)-6786,
    (int16_t)-6590,
    (int16_t)-6393,
    (int16_t)-6195,
    (int16_t)-5998,
    (int16_t)-5800,
    (int16_t)-5602,
    (int16_t)-5404,
    (int16_t)-5205,
    (int16_t)-5007,
    (int16_t)-4808,
    (int16_t)-4609,
    (int16_t)-4410,
    (int16_t)-4210,
    (int16_t)-4011,
    (int16_t)-3811,
    (int16_t)-3612,
    (int16_t)-3412,
    (int16_t)-3212,
    (int16_t)-3012,
    (int16_t)-2811,
    (int16_t)-2611,
    (int16_t)-2410,
    (int16_t)-2210,
    (int16_t)-2009,
    (int16_t)-1809,
    (int16_t)-1608,
    (int16_t)-1407,
    (int16_t)-1206,
    (int16_t)-1005,
    (int16_t)-804,
    (int16_t)-603,
    (int16_t)-402,
    (int16_t)-201,
    (int16_t)0,
    (int16_t)201,
    (int16_t)402,
    (int16_t)603,
    (int16_t)804,
    (int16_t)1005,
    (int16_t)1206,
    (int16_t)1407,
    (int16_t)1608,
    (int16_t)1809,
    (int16_t)2009,
    (int16_t)2210,
    (int16_t)2410,
    (int16_t)2611,
    (int16_t)2811,
    (int16_t)3012,
    (int16_t)3212,
    (int16_t)3412,
    (int16_t)3612,
    (int16_t)3811,
    (int16_t)4011,
    (int16_t)4210,
    (int16_t)4410,
    (int16_t)4609,
    (int16_t)4808,
    (int16_t)5007,
    (int16_t)5205,
    (int16_t)5404,
    (int16_t)5602,
    (int16_t)5800,
    (int16_t)5998,
    (int16_t)6195,
    (int16_t)6393,
    (int16_t)6590,
    (int16_t)6786,
    (int16_t)6983,
    (int16_t)7179,
    (int16_t)7375,
    (int16_t)7571,
    (int16_t)7767,
    (int16_t)7962,
    (int16_t)8157,
    (int16_t)8351,
    (int16_t)8545,
    (int16_t)8739,
    (int16_t)8933,
    (int16_t)9126,
    (int16_t)9319,
    (int16_t)9512,
    (int16_t)9704,
    (int16_t)9896,
    (int16_t)10087,
    (int16_t)10278,
    (int16_t)10469,
    (int16_t)10659,
    (int16_t)10849,
    (int16_t)11039,
    (int16_t)11228,
    (int16_t)11417,
    (int16_t)11605,
    (int16_t)11793,
    (int16_t)11980,
    (int16_t)12167,
    (int16_t)12353,
    (int16_t)12539,
    (int16_t)12725,
    (int16_t)12910,
    (int16_t)13094,
    (int16_t)13279,
    (int16_t)13462,
    (int16_t)13645,
    (int16_t)13828,
    (int16_t)14010,
    (int16_t)14191,
    (int16_t)14372,
    (int16_t)14553,
    (int16_t)14732,
    (int16_t)14912,
    (int16_t)15090,
    (int16_t)15269,
    (int16_t)15446,
    (int16_t)15623,
    (int16_t)15800,
    (int16_t)15976,
    (int16_t)16151,
    (int16_t)16325,
    (int16_t)16499,
    (int16_t)16673,
    (int16_t)16846,
    (int16_t)17018,
    (int16_t)17189,
    (int16_t)17360,
    (int16_t)17530,
    (int16_t)17700,
    (int16_t)17869,
    (int16_t)18037,
    (int16_t)18204,
    (int16_t)18371,
    (int16_t)18537,
    (int16_t)18703,
    (int16_t)18868,
    (int16_t)19032,
    (int16_t)19195,
    (int16_t)19357,
    (int16_t)19519,
    (int16_t)19680,
    (int16_t)19841,
    (int16_t)20000,
    (int16_t)20159,
    (int16_t)20317,
    (int16_t)20475,
    (int16_t)20631,
    (int16_t)20787,
    (int16_t)20942,
    (int16_t)21096,
    (int16_t)21250,
    (int16_t)21403,
    (int16_t)21554,
    (int16_t)21705,
    (int16_t)21856,
    (int16_t)22005,
    (int16_t)22154,
    (int16_t)22301,
    (int16_t)22448,
    (int16_t)22594,
    (int16_t)22739,
    (int16_t)22884,
    (int16_t)23027,
    (int16_t)23170,
    (int16_t)23311,
    (int16_t)23452,
    (int16_t)23592,
    (int16_t)23731,
    (int16_t)23870,
    (int16_t)24007,
    (int16_t)24143,
    (int16_t)24279,
    (int16_t)24413,
    (int16_t)24547,
    (int16_t)24680,
    (int16_t)24811,
    (int16_t)24942,
    (int16_t)25072,
    (int16_t)25201,
    (int16_t)25329,
    (int16_t)25456,
    (int16_t)25582,
    (int16_t)25708,
    (int16_t)25832,
    (int16_t)25955,
    (int16_t)26077,
    (int16_t)26198,
    (int16_t)26319,
    (int16_t)26438,
    (int16_t)26556,
    (int16_t)26674,
    (int16_t)26790,
    (int16_t)26905,
    (int16_t)27019,
    (int16_t)27133,
    (int16_t)27245,
    (int16_t)27356,
    (int16_t)27466,
    (int16_t)27575,
    (int16_t)27683,
    (int16_t)27790,
    (int16_t)27896,
    (int16_t)28001,
    (int16_t)28105,
    (int16_t)28208,
    (int16_t)28310,
    (int16_t)28411,
    (int16_t)28510,
    (int16_t)28609,
    (int16_t)28706,
    (int16_t)28803,
    (int16_t)28898,
    (int16_t)28992,
    (int16_t)29085,
    (int16_t)29177,
    (int16_t)29268,
    (int16_t)29358,
    (int16_t)29447,
    (int16_t)29534,
    (int16_t)29621,
    (int16_t)29706,
    (int16_t)29791,
    (int16_t)29874,
    (int16_t)29956,
    (int16_t)30037,
    (int16_t)30117,
    (int16_t)30195,
    (int16_t)30273,
    (int16_t)30349,
    (int16_t)30424,
    (int16_t)30498,
    (int16_t)30571,
    (int16_t)30643,
    (int16_t)30714,
    (int16_t)30783,
    (int16_t)30852,
    (int16_t)30919,
    (int16_t)30985,
    (int16_t)31050,
    (int16_t)31113,
    (int16_t)31176,
    (int16_t)31237,
    (int16_t)31297,
    (int16_t)31356,
    (int16_t)31414,
    (int16_t)31470,
    (int16_t)31526,
    (int16_t)31580,
    (int16_t)31633,
    (int16_t)31685,
    (int16_t)31736,
    (int16_t)31785,
    (int16_t)31833,
    (int16_t)31880,
    (int16_t)31926,
    (int16_t)31971,
    (int16_t)32014,
    (int16_t)32057,
    (int16_t)32098,
    (int16_t)32137,
    (int16_t)32176,
    (int16_t)32213,
    (int16_t)32250,
    (int16_t)32285,
    (int16_t)32318,
    (int16_t)32351,
    (int16_t)32382,
    (int16_t)32412,
    (int16_t)32441,
    (int16_t)32469,
    (int16_t)32495,
    (int16_t)32521,
    (int16_t)32545,
    (int16_t)32567,
    (int16_t)32589,
    (int16_t)32609,
    (int16_t)32628,
    (int16_t)32646,
    (int16_t)32663,
    (int16_t)32678,
    (int16_t)32692,
    (int16_t)32705,
    (int16_t)32717,
    (int16_t)32728,
    (int16_t)32737,
    (int16_t)32745,
    (int16_t)32752,
    (int16_t)32757,
    (int16_t)32761,
    (int16_t)32765,
    (int16_t)32766
  };

  static const int16_t __not_in_flash_func(process_cw)(const bool keydown,const bool gaussian)
  {
    volatile static uint32_t phase = 0;
    volatile static uint32_t gaussian_phase = 0;
    int16_t sig = 0;
    if (gaussian)
    {
      volatile static enum cw_state_t
      {
        CW_STATE_KEYUP,
        CW_STATE_KEYDOWN,
        CW_STATE_KEY_TRANSITION_TO_DOWN,
        CW_STATE_KEY_TRANSITION_TO_UP
      }
      cw_state = CW_STATE_KEYUP;
      switch (cw_state)
      {
        case CW_STATE_KEYUP:
        {
          // if keydown then transition to key down
          if (keydown)
          {
            gaussian_phase = 311;
            cw_state = CW_STATE_KEY_TRANSITION_TO_DOWN;
          }
          break;
        }
        case CW_STATE_KEY_TRANSITION_TO_DOWN:
        {
          // stay here until gaussian done
          const int32_t gaussian = gaussian_tab[gaussian_phase];
          const int32_t bfo = fs4tab[phase & 0x03];
          sig = (bfo * gaussian) >> 15;
          phase++;
          gaussian_phase--;
          if (gaussian_phase==0)
          {
            cw_state = CW_STATE_KEYDOWN;
          }
          break;
        }
        case CW_STATE_KEYDOWN:
        {
          // stay here while key down
          sig = fs4tab[phase & 0x03];
          phase++;
          if (keydown)
          {
            break;
          }
          gaussian_phase = 0;
          cw_state = CW_STATE_KEY_TRANSITION_TO_UP;
          break;
        }
        case CW_STATE_KEY_TRANSITION_TO_UP:
        {
          // stay here until gaussian done
          const int32_t gaussian = gaussian_tab[gaussian_phase];
          const int32_t bfo = fs4tab[phase & 0x03];
          sig = (bfo * gaussian) >> 15;
          phase++;
          gaussian_phase++;
          if (gaussian_phase>=312)
          {
            cw_state = CW_STATE_KEYUP;
          }
          break;
        }
      }
    }
    else
    {
      // gaussian off
      if (keydown)
      {
        sig = fs4tab[phase & 0x03];
        phase++;
      }
    }
    return sig;
  }

  static const int16_t get_sidetone(const bool keydown)
  {
    volatile static uint32_t dds = 0;
    static const uint32_t sidetone = CW_SIDETONE;
    static const uint32_t sidetone_phase = ((uint64_t)sidetone * (1ull << 32)) / SAMPLERATE;
    int16_t s = 0;
    if (keydown)
    {
      s = sin_tab[dds>>22];
      s >>= 9;
    }
    dds += sidetone_phase;
    return s;
  }
}

#endif